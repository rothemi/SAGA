# Microarray annotation

Since microarray probe annotation may change as the genome annotation advances, we re-annotated the 39,428 probes on the Agilent Whole Mouse Genome Oligo Microarray 4x44K v2 (Design ID 026655) by mapping the 60mer sequences to a recent release of the murine transcriptome (Gencode version M18, GRCm38.p6, release 07/2018). The transcript databases were downloaded as FASTA files for the 64,732 protein coding transcripts (ftp://ftp.ebi.ac.uk/pub/databases/gencode/Gencode_mouse/release_M18/gencode.vM18.pc_transcripts.fa.gz) and for all 136,535 coding and noncoding transcripts of the reference transcriptome (ftp://ftp.ebi.ac.uk/pub/databases/gencode/Gencode_mouse/release_M18/gencode.vM18.transcripts.fa.gz). The annotation was performed using R 3.5.1, Bioconductor 3.7 and the R package “Biostrings”. Due to their higher expression compared to non-coding transcripts we prioritized protein coding sequences by aligning the 60mers first to all protein coding transcripts of Gencode M18, and second to all transcripts of Gencode M18 allowing a maximum of 3 mismatches per 60mer. Using these parameters 33,361 out of 39,428 probes were successfully mapped to the Gencode M18 transcriptome. The mapping process retrieved an Ensembl-GeneID (e.g. “ENSMUSG00000020743”) for each probe with a hit in the Gencode transcriptome. The Ensembl-GeneID was further annotated using the “BiomaRt” R package to retrieve gene symbols, description and gene type from the Ensembl 94 database. For probes that could not be annotated by Gencode, annotation was taken from the latest annotation file for the Whole Mouse Genome Oligo Microarray 4x44K v2 downloaded from Agilent eArray web service (https://earray.chem.agilent.com/earray/, ID 026655, released October 2017) resulting in annotation of 2872 additional probes and 36,226 annotated probes in total. The R script for the annotation and all files used are available in the GitHub repository accompanying this manuscript. 

## Availability of raw data and R workspace file

*	[Microarray annotation.RData](https://www.dropbox.com/sh/xo6uyl2p8w8848e/AACfnRU88LyVJ5tT6yMKaeF1a?dl=0)
*	[Annotation_GencodeM18_3MM_BioMart_FINAL.R](./Annotation_GencodeM18_3MM_BioMart_FINAL.R)
