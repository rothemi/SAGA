# Microarray Data Processing

processing The data was analyzed using R 3.5.1 and Bioconductor 3.7. Raw files were read in separately for each array design with the function “read.maimages” from the R package “limma”. A merged dataset was created by extracting all probes derived from the original Agilent Mouse Genome Oligo Microarray 4x44K v2 array from the four array platforms and combining them using the function “cbind.EList” from “limma”. The probe with the ID “A_55_P2337033“ interrogating the gene “2310065F04Rik” was excluded from the dataset since it strongly cross-reacted with the sequence of EGFP. Array quality was assessed by interrogation of probe intensity distributions and by principal component analysis of log2-transformed unprocessed data. At this point, one complete SAGA assay and two outlier arrays were excluded from further analysis due to low overall signal strength. The Raw data was log2-transformed and quantile-normalized using the ”limma” package. The success of preprocessing was verified by inspection of probe intensity distributions before and after preprocessing. The four within-array replicates of each probe were collapsed using the “avereps” function from the R package “limma” resulting in a dataset with 39,428 unique probes. Probes interrogating the same gene were not collapsed further since most genes were only interrogated by one probe on this platform. In the quantile-normalized data, a substantial batch effect between different SAGA assays was observed. Batch correction between different SAGA assays was performed on quantile-normalized log2-values using the parametric ComBat algorithm as implemented in the R package “sva” with the SAGA number as batch variable and all other parameters set to default. Importantly, the group label was not supplied as covariate to ComBat, since this can lead to spurious group differences and overly optimistic p-values between groups in downstream analyses.

## Availability of raw data and R workspace file

*	[Expression set analysis.RData](https://www.dropbox.com/s/9c50c0koi1m536v/Expression%20set%20analysis.RData?dl=0)
*	[R_SAGA_FinalDataSet_GSEA_169.R](./R_SAGA_FinalDataSet_GSEA_169.R)
